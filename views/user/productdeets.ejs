<%- include('../layouts/header') %>    
<%- include('../layouts/Login/loginHeader') %>
    <main class="main">
            <nav aria-label="breadcrumb" class="breadcrumb-nav border-0 mb-0">
                <div class="container d-flex align-items-center">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="/">Home</a></li>
                        <li class="breadcrumb-item"><a href="#"><%=products.category.name%></a></li>
                        <li class="breadcrumb-item active" aria-current="page"><%=products.name%></li>
                       
                    </ol>

                    <nav class="productss-pager ml-auto" aria-label="productss">
                        <a class="productss-pager-link productss-pager-prev" href="#" aria-label="Previous" tabindex="-1">
                            <i class="icon-angle-left"></i>
                            <span>Prev</span>
                        </a>

                        <a class="productss-pager-link productss-pager-next" href="#" aria-label="Next" tabindex="-1">
                            <span>Next</span>
                            <i class="icon-angle-right"></i>
                        </a>
                    </nav><!-- End .pager-nav -->
                </div><!-- End .container -->
            </nav><!-- End .breadcrumb-nav -->


<div class="page-content">
    <div class="container">
        <div class="product-details-top mb-2">
            <div class="row">
                <div class="col-md-6">
                    <div class="product-gallery product-gallery-vertical">
                        <div class="row" >
                            <figure class="product-main-image"  >
                                <% let mainImage = products.pictures[0].replace('public', ''); %>
                                <img id="product-zoom" src="<%=mainImage%>" data-zoom-image="<%=mainImage%>" alt="product image">

                                <a href="#" id="btn-product-gallery" class="btn-product-gallery">
                                    <i class="icon-arrows"></i>
                                </a>
                            </figure><!-- End .product-main-image -->
                             <!-- Additional images from the pictures array -->
                            
                            <div id="product-zoom-gallery" class="product-image-gallery" >
                                <% for (let i = 0; i < Math.min(products.pictures.length, 4); i++) { %>
                                    <% let additionalImage = products.pictures[i].replace('public', ''); %>
                                   
                                <a class="product-gallery-item active" href="#" data-image="<%= additionalImage %>" data-zoom-image="<%= additionalImage %>" >
                                    <img src="<%= additionalImage %>" alt="product side">
                                </a>
                                <% } %> 
                            </div><!-- End .product-image-gallery -->
                           
                           
                        </div><!-- End .row -->
                    </div><!-- End .product-gallery -->
                </div><!-- End .col-md-6 -->

                <div class="col-md-6">
                    <div class="product-details product-details-centered">
                        <h1 class="product-title"><%=products.name%></h1><!-- End .product-title -->

                        

                        <div class="product-price">
                            â‚¹<%=products.price%>
                        </div><!-- End .product-price -->

                        <div class="product-content">
                            <p><%=products.description%></p>
                        </div><!-- End .product-content -->

                        

                        <div class="product-details-action">
                            <div class="details-action-col">
                                <div class="product-details-quantity">
                                    <input type="number" id="qty" class="form-control" value="1" min="1" max="10" step="1" data-decimals="0" required>
                                </div><!-- End .product-details-quantity -->
                                <button class="btn-product btn-cart" onclick="addtocart('<%=products.name%>','<%=email%>')">Add to cart</button>
                               
                            </div><!-- End .details-action-col -->

                            <div class="details-action-wrapper">
                                <a href="#" class="btn-product btn-wishlist" title="Wishlist"><span>Add to Wishlist</span></a>
                               
                            </div><!-- End .details-action-wrapper -->
                        </div><!-- End .product-details-action -->

                        <div class="product-details-footer">
                            <div class="product-cat">
                                <span>Category:</span>
                                <a href="/category?cat=<%= products.category.name %>"><%= products.category.name %></a>
                                
                            </div><!-- End .product-cat -->

                            <div class="social-icons social-icons-sm">
                                <span class="social-label">Share:</span>
                                <a href="#" class="social-icon" title="Facebook" target="_blank"><i class="icon-facebook-f"></i></a>
                                <a href="#" class="social-icon" title="Twitter" target="_blank"><i class="icon-twitter"></i></a>
                                <a href="#" class="social-icon" title="Instagram" target="_blank"><i class="icon-instagram"></i></a>
                                <a href="#" class="social-icon" title="Pinterest" target="_blank"><i class="icon-pinterest"></i></a>
                            </div>
                        </div><!-- End .product-details-footer -->
                    </div><!-- End .product-details -->
                </div><!-- End .col-md-6 -->
            </div><!-- End .row -->
        </div><!-- End .product-details-top -->


            
        </main><!-- End .main -->

        <%- include('../layouts/footer') %>

        <script>
            function addtocart(prodname,email)
            {
            fetch(`/productaddtocart?name=${prodname}&email=${email}`, {
            method: 'POST', // Use POST or PATCH for updating data
            headers: {
            'Content-Type': 'application/json',
             },
        
    }).then(response => {
            if (!response.ok) {
                throw new Error(`HTTP error! Status: ${response.status}`);
            }
            // You can handle the response if needed
            return response.json();
        })
        .then(data => {
            // Update the button text and class
            document.querySelector('.btn-cart').textContent = 'Added to Cart';
            document.querySelector('.btn-cart').classList.add('added-to-cart');
 
            // $('#block').load('/admin/users #block')
            
           
        })
        .catch(error => {
            console.error('Error:', error);
        });
}

            
        </script>
        <%- include('../layouts/Login/LoginMob') %>